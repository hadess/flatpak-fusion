{
    "app-id": "org.emulationstation.app",
    "runtime": "org.freedesktop.Platform",
    "runtime-version": "1.4",
    "sdk": "org.freedesktop.Sdk",
    "rename-desktop-file": "EmulationStation.desktop",
    "rename-icon": "EmulationStation",
    "command": "emulationstation",
    "separate-locales": false,
    "finish-args": [
        /* X11 + XShm access */
        "--share=ipc", "--socket=x11",
        /* Wayland access */
        "--socket=wayland",
        /* OpenGL access */
        "--device=dri",
        /* Needs to talk to the network: */
        "--share=network",
        /* XXX This sucks */
        "--filesystem=home",
        /* Play sounds */
        "--socket=pulseaudio",
        /* Browse user's Videos directory */
        "--filesystem=xdg-videos",
        /* Browse gvfs */
        "--talk-name=org.gtk.vfs", "--talk-name=org.gtk.vfs.*",
        /* xdg-screensaver */
        "--talk-name=org.gnome.ScreenSaver"
    ],
    "build-options" : {
        "cflags": "-O2 -g",
        "cxxflags": "-O2 -g"
    },
    "cleanup": [ "/include", "/share/bash-completion", "/lib/pkgconfig/", "/lib/*.a", "/lib/*.la", "/bin/av*", "/bin/fribidi", "/bin/*asm" ],
    "modules": [
        {
            "name": "freeimage",
            "make-args": [ "-f", "Makefile.gnu" ],
            "make-install-args": [ "DESTDIR=/app", "INCDIR=/app/include", "INSTALLDIR=/app/lib/"  ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://downloads.sourceforge.net/freeimage/FreeImage3170.zip",
                    "sha256": "fbfc65e39b3d4e2cb108c4ffa8c41fd02c07d4d436c594fff8dab1a6d5297f89"
                },
                {
                    "type": "patch",
                    "path": "FreeImage-3.17.0_unbundle.patch"
                },
                {
                    "type": "patch",
                    "path": "FreeImage-3.17.0_disable-plugins.patch"
                },
                {
                    "type": "patch",
                    "path": "FreeImage-3.17.0_install.patch"
                },
                {
                    "type": "file",
                    "path": "freeimage-configure",
                    "dest-filename": "configure"
                }
            ],
            "cleanup": [
                    "/lib/*.a"
            ]
        },
        {
            "name": "boost",
            "config-opts": [ "--with-libraries=date_time,filesystem,locale,system" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://downloads.sourceforge.net/project/boost/boost/1.60.0/boost_1_60_0.tar.bz2",
                    "sha256": "686affff989ac2488f79a97b9479efb9f2abae035b5ed4d8226de6857933fd3b"
                },
                {
                    "type": "file",
                    "path": "boost-configure",
                    "dest-filename": "configure"
                }
            ],
            "cleanup": [
                    "/lib/libboost_*.a"
            ]
        },
        {
            "name": "eigen3",
            "cmake": true,
            "builddir": true,
            "sources": [
                {
                    "type": "archive",
                    "url": "http://bitbucket.org/eigen/eigen/get/3.1.3.tar.bz2",
                    "sha256": "1a443145f321dd47a5ca11f176e7319056198a6124a7577723d92e3c3cd59ece"
                }
            ]
        },
        {
            "name": "libretro-genesis_plus_gx",
            "make-install-args": [ "NAME=genesis_plus_gx" ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/libretro/Genesis-Plus-GX.git"
                },
                {
                    "type": "file",
                    "path": "retro-configure",
                    "dest-filename": "configure"
                },
                {
                    "type": "file",
                    "path": "genesis_plus_gx_libretro.info"
                }
            ]
        },
        {
            "name": "libretro-mame",
            "make-install-args": [ "NAME=mame" ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/libretro/mame.git"
                },
                {
                    "type": "file",
                    "path": "retro-configure",
                    "dest-filename": "configure"
                },
                {
                    "type": "file",
                    "path": "mame_libretro.info"
                }
            ]
        },
        {
            "name": "libretro-mupen64plus",
            "make-install-args": [ "-f", "Makefile.local", "NAME=mupen64plus" ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/libretro/mupen64plus-libretro.git"
                },
                {
                    "type": "file",
                    "path": "retro-configure",
                    "dest-filename": "configure"
                },
                {
                    "type": "file",
                    "path": "mupen64plus_libretro.info"
                }
            ]
        },
        {
            "name": "retroarch",
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/libretro/RetroArch.git"
                }
            ]
        },
        {
            "name": "EmulationStation",
            "cmake": true,
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/Aloshi/EmulationStation.git"
                },
                {
                    "type": "patch",
                    "path": "0001-Add-.desktop-file-for-Linux-front-end.patch"
                }
            ]
        }
    ]
}
